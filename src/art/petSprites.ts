// ============================================
// GRUNDY — PET SPRITES
// P5-ART-PETS: Maps PetId + PetPose to sprite assets
// P6-ART-POSES: Extended pose support for all available sprites
// All art imported from assets/pets/<petId>/*.png
// ============================================

// --- Munchlet sprites ---
import munchletIdle from '../../assets/pets/munchlet/munchlet_idle.png';
import munchletHappy from '../../assets/pets/munchlet/munchlet_happy.png';
import munchletSad from '../../assets/pets/munchlet/munchlet_sad.png';
import munchletSleeping from '../../assets/pets/munchlet/munchlet_sleeping.png';
import munchletEating from '../../assets/pets/munchlet/munchlet_eating.png';
import munchletEatingLoved from '../../assets/pets/munchlet/munchlet_eating_loved.png';
import munchletEcstatic from '../../assets/pets/munchlet/munchlet_ecstatic.png';
import munchletExcited from '../../assets/pets/munchlet/munchlet_excited.png';
import munchletHungry from '../../assets/pets/munchlet/munchlet_hungry.png';
import munchletSatisfied from '../../assets/pets/munchlet/munchlet_satisfied.png';
import munchletCrying from '../../assets/pets/munchlet/munchlet_crying.png';

// --- Grib sprites ---
import gribIdle from '../../assets/pets/grib/grib_idle.png';
import gribHappy from '../../assets/pets/grib/grib_happy.png';
import gribSad from '../../assets/pets/grib/grib_sad.png';
import gribSleeping from '../../assets/pets/grib/grib_sleeping.png';
import gribEating from '../../assets/pets/grib/grib_eating.png';
import gribEatingLoved from '../../assets/pets/grib/grib_eating_loved.png';
import gribEcstatic from '../../assets/pets/grib/grib_ecstatic.png';
import gribExcited from '../../assets/pets/grib/grib_excited.png';
import gribHungry from '../../assets/pets/grib/grib_hungry.png';
import gribSatisfied from '../../assets/pets/grib/grib_satisfied.png';
import gribCrying from '../../assets/pets/grib/grib_crying.png';

// --- Plompo sprites ---
import plompoIdle from '../../assets/pets/plompo/plompo_idle.png';
import plompoHappy from '../../assets/pets/plompo/plompo_happy.png';
import plompoSad from '../../assets/pets/plompo/plompo_sad.png';
import plompoSleeping from '../../assets/pets/plompo/plompo_sleeping.png';
import plompoEating from '../../assets/pets/plompo/plompo_eating.png';
import plompoEatingLoved from '../../assets/pets/plompo/plompo_eating_loved.png';
import plompoEcstatic from '../../assets/pets/plompo/plompo_ecstatic.png';
import plompoExcited from '../../assets/pets/plompo/plompo_excited.png';
import plompoHungry from '../../assets/pets/plompo/plompo_hungry.png';
import plompoSatisfied from '../../assets/pets/plompo/plompo_satisfied.png';
import plompoCrying from '../../assets/pets/plompo/plompo_crying.png';

// --- Fizz sprites ---
import fizzIdle from '../../assets/pets/fizz/fizz_idle.png';
import fizzHappy from '../../assets/pets/fizz/fizz_happy.png';
import fizzSad from '../../assets/pets/fizz/fizz_sad.png';
import fizzSleeping from '../../assets/pets/fizz/fizz_sleeping.png';
import fizzEating from '../../assets/pets/fizz/fizz_eating.png';
import fizzEatingLoved from '../../assets/pets/fizz/fizz_eating_loved.png';
import fizzEcstatic from '../../assets/pets/fizz/fizz_ecstatic.png';
import fizzExcited from '../../assets/pets/fizz/fizz_excited.png';
import fizzHungry from '../../assets/pets/fizz/fizz_hungry.png';
import fizzSatisfied from '../../assets/pets/fizz/fizz_satisfied.png';
import fizzCrying from '../../assets/pets/fizz/fizz_crying.png';

// --- Ember sprites ---
import emberIdle from '../../assets/pets/ember/ember_idle.png';
import emberHappy from '../../assets/pets/ember/ember_happy.png';
import emberSad from '../../assets/pets/ember/ember_sad.png';
import emberSleeping from '../../assets/pets/ember/ember_sleeping.png';
import emberEating from '../../assets/pets/ember/ember_eating.png';
import emberEatingLoved from '../../assets/pets/ember/ember_eating_loved.png';
import emberEcstatic from '../../assets/pets/ember/ember_ecstatic.png';
import emberExcited from '../../assets/pets/ember/ember_excited.png';
import emberHungry from '../../assets/pets/ember/ember_hungry.png';
import emberSatisfied from '../../assets/pets/ember/ember_satisfied.png';
import emberCrying from '../../assets/pets/ember/ember_crying.png';

// --- Chomper sprites ---
import chomperIdle from '../../assets/pets/chomper/chomper_idle.png';
import chomperHappy from '../../assets/pets/chomper/chomper_happy.png';
import chomperSad from '../../assets/pets/chomper/chomper_sad.png';
import chomperSleeping from '../../assets/pets/chomper/chomper_sleeping.png';
import chomperEating from '../../assets/pets/chomper/chomper_eating.png';
import chomperEatingLoved from '../../assets/pets/chomper/chomper_eating_loved.png';
import chomperEcstatic from '../../assets/pets/chomper/chomper_ecstatic.png';
import chomperExcited from '../../assets/pets/chomper/chomper_excited.png';
import chomperHungry from '../../assets/pets/chomper/chomper_hungry.png';
import chomperSatisfied from '../../assets/pets/chomper/chomper_satisfied.png';
import chomperCrying from '../../assets/pets/chomper/chomper_crying.png';

// --- Whisp sprites ---
import whispIdle from '../../assets/pets/whisp/whisp_idle.png';
import whispHappy from '../../assets/pets/whisp/whisp_happy.png';
import whispSad from '../../assets/pets/whisp/whisp_sad.png';
import whispSleeping from '../../assets/pets/whisp/whisp_sleeping.png';
import whispEatingLoved from '../../assets/pets/whisp/whisp_eating_loved.png';
import whispEcstatic from '../../assets/pets/whisp/whisp_ecstatic.png';
import whispExcited from '../../assets/pets/whisp/whisp_excited.png';
import whispHungry from '../../assets/pets/whisp/whisp_hungry.png';
import whispSatisfied from '../../assets/pets/whisp/whisp_satisfied.png';

// --- Luxe sprites ---
import luxeIdle from '../../assets/pets/luxe/luxe_idle.png';
import luxeHappy from '../../assets/pets/luxe/luxe_happy.png';
import luxeSad from '../../assets/pets/luxe/luxe_sad.png';
import luxeSleeping from '../../assets/pets/luxe/luxe_sleeping.png';
import luxeEating from '../../assets/pets/luxe/luxe_eating.png';
import luxeEatingLoved from '../../assets/pets/luxe/luxe_eating_loved.png';
import luxeEcstatic from '../../assets/pets/luxe/luxe_ecstatic.png';
import luxeExcited from '../../assets/pets/luxe/luxe_excited.png';
import luxeHungry from '../../assets/pets/luxe/luxe_hungry.png';
import luxeSatisfied from '../../assets/pets/luxe/luxe_satisfied.png';
import luxeCrying from '../../assets/pets/luxe/luxe_crying.png';

import type { EvolutionStage } from '../types';

// ============================================
// TYPES
// ============================================

/**
 * Pet pose states for sprite selection.
 * Maps to available art in assets/pets/<petId>/*.png
 *
 * Core poses (all pets):
 * - idle: Default resting state
 * - happy: Positive mood
 * - sad: Negative mood
 * - sleeping: Sleep state
 *
 * Extended poses (P6-ART-POSES):
 * - eating: During feeding animation
 * - eating_loved: Feeding loved food
 * - ecstatic: Maximum happiness
 * - excited: High energy state
 * - hungry: Low fullness state
 * - satisfied: High fullness (SATISFIED/STUFFED)
 * - crying: Distress state
 */
export type PetPose =
  | 'idle'
  | 'happy'
  | 'sad'
  | 'sleeping'
  | 'eating'
  | 'eating_loved'
  | 'ecstatic'
  | 'excited'
  | 'hungry'
  | 'satisfied'
  | 'crying';

/**
 * Extended sprite set for a pet with all available poses.
 * - idle & happy are required (always available)
 * - All other poses are optional (fall back to idle/happy/sad)
 */
export interface PetSpriteSet {
  idle: string;
  happy: string;
  sad?: string;
  sleeping?: string;
  eating?: string;
  eating_loved?: string;
  ecstatic?: string;
  excited?: string;
  hungry?: string;
  satisfied?: string;
  crying?: string;
}

/**
 * All 8 pet IDs from Bible §3
 */
export type PetId =
  | 'munchlet'
  | 'grib'
  | 'plompo'
  | 'fizz'
  | 'ember'
  | 'chomper'
  | 'whisp'
  | 'luxe';

// ============================================
// SPRITE REGISTRY
// ============================================

/**
 * Master sprite registry mapping each PetId to its sprite set.
 * All 8 pets have core sprite sets (idle, happy, sad, sleeping).
 * Extended poses added per P6-ART-POSES.
 */
export const PET_SPRITES: Record<PetId, PetSpriteSet> = {
  munchlet: {
    idle: munchletIdle,
    happy: munchletHappy,
    sad: munchletSad,
    sleeping: munchletSleeping,
    eating: munchletEating,
    eating_loved: munchletEatingLoved,
    ecstatic: munchletEcstatic,
    excited: munchletExcited,
    hungry: munchletHungry,
    satisfied: munchletSatisfied,
    crying: munchletCrying,
  },
  grib: {
    idle: gribIdle,
    happy: gribHappy,
    sad: gribSad,
    sleeping: gribSleeping,
    eating: gribEating,
    eating_loved: gribEatingLoved,
    ecstatic: gribEcstatic,
    excited: gribExcited,
    hungry: gribHungry,
    satisfied: gribSatisfied,
    crying: gribCrying,
  },
  plompo: {
    idle: plompoIdle,
    happy: plompoHappy,
    sad: plompoSad,
    sleeping: plompoSleeping,
    eating: plompoEating,
    eating_loved: plompoEatingLoved,
    ecstatic: plompoEcstatic,
    excited: plompoExcited,
    hungry: plompoHungry,
    satisfied: plompoSatisfied,
    crying: plompoCrying,
  },
  fizz: {
    idle: fizzIdle,
    happy: fizzHappy,
    sad: fizzSad,
    sleeping: fizzSleeping,
    eating: fizzEating,
    eating_loved: fizzEatingLoved,
    ecstatic: fizzEcstatic,
    excited: fizzExcited,
    hungry: fizzHungry,
    satisfied: fizzSatisfied,
    crying: fizzCrying,
  },
  ember: {
    idle: emberIdle,
    happy: emberHappy,
    sad: emberSad,
    sleeping: emberSleeping,
    eating: emberEating,
    eating_loved: emberEatingLoved,
    ecstatic: emberEcstatic,
    excited: emberExcited,
    hungry: emberHungry,
    satisfied: emberSatisfied,
    crying: emberCrying,
  },
  chomper: {
    idle: chomperIdle,
    happy: chomperHappy,
    sad: chomperSad,
    sleeping: chomperSleeping,
    eating: chomperEating,
    eating_loved: chomperEatingLoved,
    ecstatic: chomperEcstatic,
    excited: chomperExcited,
    hungry: chomperHungry,
    satisfied: chomperSatisfied,
    crying: chomperCrying,
  },
  whisp: {
    idle: whispIdle,
    happy: whispHappy,
    sad: whispSad,
    sleeping: whispSleeping,
    // whisp has no eating sprite, falls back
    eating_loved: whispEatingLoved,
    ecstatic: whispEcstatic,
    excited: whispExcited,
    hungry: whispHungry,
    satisfied: whispSatisfied,
    // whisp has no crying sprite, falls back
  },
  luxe: {
    idle: luxeIdle,
    happy: luxeHappy,
    sad: luxeSad,
    sleeping: luxeSleeping,
    eating: luxeEating,
    eating_loved: luxeEatingLoved,
    ecstatic: luxeEcstatic,
    excited: luxeExcited,
    hungry: luxeHungry,
    satisfied: luxeSatisfied,
    crying: luxeCrying,
  },
};

// ============================================
// HELPER FUNCTIONS
// ============================================

/**
 * Pose fallback chain for graceful degradation.
 * If a pose isn't available, try these alternatives in order.
 */
const POSE_FALLBACKS: Record<PetPose, PetPose[]> = {
  idle: [],
  happy: ['idle'],
  sad: ['idle'],
  sleeping: ['idle'],
  eating: ['happy', 'idle'],
  eating_loved: ['eating', 'ecstatic', 'happy', 'idle'],
  ecstatic: ['happy', 'idle'],
  excited: ['happy', 'idle'],
  hungry: ['sad', 'idle'],
  satisfied: ['happy', 'idle'],
  crying: ['sad', 'idle'],
};

/**
 * Get the sprite path for a specific pet and pose.
 *
 * @param petId - The pet ID (munchlet, grib, plompo, fizz, ember, chomper, whisp, luxe)
 * @param pose - The pose to display
 * @param stage - Optional evolution stage (for future stage-specific sprites)
 * @returns The sprite path (imported image URL)
 *
 * Fallback behavior:
 * - If the pet ID is not found, returns munchlet's idle sprite
 * - If the requested pose is not available, falls back through POSE_FALLBACKS chain
 * - Stage parameter reserved for future stage-specific sprites
 */
export function getPetSprite(
  petId: string,
  pose: PetPose,
  _stage?: EvolutionStage
): string {
  const set = PET_SPRITES[petId as PetId];

  // Fallback for unknown pet IDs
  if (!set) {
    console.warn(`[petSprites] Unknown petId: ${petId}, falling back to munchlet`);
    return PET_SPRITES.munchlet.idle;
  }

  // Try to get the requested pose
  const sprite = set[pose];
  if (sprite) {
    return sprite;
  }

  // Try fallback chain
  const fallbacks = POSE_FALLBACKS[pose] || [];
  for (const fallbackPose of fallbacks) {
    const fallbackSprite = set[fallbackPose];
    if (fallbackSprite) {
      return fallbackSprite;
    }
  }

  // Ultimate fallback to idle
  return set.idle;
}

/**
 * Check if a pet has a specific pose available.
 *
 * @param petId - The pet ID
 * @param pose - The pose to check
 * @returns True if the pose exists for this pet
 */
export function hasPetPose(petId: string, pose: PetPose): boolean {
  const set = PET_SPRITES[petId as PetId];
  if (!set) return false;

  return set[pose] !== undefined;
}

/**
 * Get all available poses for a pet.
 *
 * @param petId - The pet ID
 * @returns Array of available pose names
 */
export function getAvailablePoses(petId: string): PetPose[] {
  const set = PET_SPRITES[petId as PetId];
  if (!set) return [];

  const poses: PetPose[] = [];
  const allPoses: PetPose[] = [
    'idle',
    'happy',
    'sad',
    'sleeping',
    'eating',
    'eating_loved',
    'ecstatic',
    'excited',
    'hungry',
    'satisfied',
    'crying',
  ];

  for (const pose of allPoses) {
    if (set[pose]) {
      poses.push(pose);
    }
  }

  return poses;
}

/**
 * List of all pet IDs in the sprite registry.
 */
export const ALL_PET_IDS: PetId[] = [
  'munchlet',
  'grib',
  'plompo',
  'fizz',
  'ember',
  'chomper',
  'whisp',
  'luxe',
];

/**
 * Core poses that all pets should have.
 */
export const CORE_POSES: PetPose[] = ['idle', 'happy', 'sad', 'sleeping'];

/**
 * Extended poses added in P6-ART-POSES.
 */
export const EXTENDED_POSES: PetPose[] = [
  'eating',
  'eating_loved',
  'ecstatic',
  'excited',
  'hungry',
  'satisfied',
  'crying',
];
